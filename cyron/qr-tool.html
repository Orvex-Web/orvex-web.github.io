<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>QR Scanner & Generator Pro</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
  <style>
:root {
    --color-primary: #00d4ff;
    --color-primary-dark: #00a6ff;
    --color-bg: #0a0f1c;
    --color-text: #ffffff;
    --color-glass: rgba(255, 255, 255, 0.08);
    --color-border: rgba(255, 255, 255, 0.15);
    --color-shadow: rgba(0, 0, 0, 0.25);
    --color-card: rgba(30, 35, 50, 0.5);
    --color-success: #00c853;
    --transition: all 0.3s ease;
  }

    @media (prefers-color-scheme: light) {
:root {
      --color-bg: #f5f7ff;
      --color-text: #1a1a1a;
      --color-glass: rgba(255, 255, 255, 0.7);
      --color-border: rgba(0, 0, 0, 0.1);
      --color-shadow: rgba(0, 0, 0, 0.1);
      --color-card: rgba(255, 255, 255, 0.7);
      --color-success: #00c853;
    }
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      background: var(--color-bg);
      color: var(--color-text);
      font-family: 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      padding: 15px;
      line-height: 1.5;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at top right, rgba(0, 212, 255, 0.1) 0%, transparent 40%),
      radial-gradient(circle at bottom left, rgba(0, 212, 255, 0.1) 0%, transparent 40%);
      z-index: -1;
    }

    .container {
      max-width: 500px;
      width: 100%;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 20px;
      flex: 1;
    }

    /* Header */
    .header {
      text-align: center;
      padding: 25px 15px;
      background: var(--color-glass);
      backdrop-filter: blur(12px);
      border-radius: 20px;
      border: 1px solid var(--color-border);
      box-shadow: 0 8px 24px var(--color-shadow);
      margin-bottom: 10px;
      position: relative;
      overflow: hidden;
    }

    .header::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--color-primary), var(--color-primary-dark));
    }

    .header h1 {
      font-size: 1.8rem;
      margin-bottom: 10px;
      background: linear-gradient(90deg, var(--color-primary), var(--color-primary-dark));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 700;
    }

    .header p {
      font-size: 1rem;
      opacity: 0.9;
      max-width: 320px;
      margin: 0 auto;
    }

    /* Navigation */
    .tabs {
      display: flex;
      background: var(--color-card);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 8px;
      box-shadow: 0 6px 16px var(--color-shadow);
      margin-bottom: 5px;
    }

    .tab-btn {
      flex: 1;
      padding: 14px 10px;
      border-radius: 14px;
      border: none;
      background: transparent;
      color: var(--color-text);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      transition: var(--transition);
    }

    .tab-btn.active {
      background: rgba(0, 212, 255, 0.15);
      color: var(--color-primary);
      box-shadow: 0 0 15px rgba(0, 212, 255, 0.25);
    }

    .tab-btn i {
      font-size: 1.2rem;
    }

    /* Main content */
    .tab-content {
      display: none;
      flex: 1;
      flex-direction: column;
      gap: 20px;
    }

    .tab-content.active {
      display: flex;
      animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(15px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Scanner section */
    .scanner-section {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .scanner-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }

    .option-card {
      background: var(--color-card);
      backdrop-filter: blur(10px);
      border-radius: 18px;
      padding: 20px 15px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid var(--color-border);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      box-shadow: 0 6px 14px var(--color-shadow);
    }

    .option-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px var(--color-shadow);
      border-color: var(--color-primary);
    }

    .option-card i {
      font-size: 2.6rem;
      color: var(--color-primary);
    }

    .option-card h3 {
      font-size: 1.2rem;
      margin-bottom: 4px;
    }

    .option-card p {
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .preview-container {
      position: relative;
      width: 100%;
      aspect-ratio: 1/1;
      border-radius: 18px;
      overflow: hidden;
      display: none;
      background: rgba(0, 0, 0, 0.1);
      border: 1px dashed var(--color-border);
      box-shadow: 0 6px 16px var(--color-shadow);
    }

    .preview-container.active {
      display: block;
    }

    #image-preview, #camera-preview {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: none;
    }

    #camera-preview.active, #image-preview.active {
      display: block;
    }

    .scan-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: rgba(10, 15, 28, 0.92);
      z-index: 10;
    }

    .scan-overlay.active {
      display: flex;
    }

    .scan-animation {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    .scan-frame {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 8px;
      box-shadow: 0 0 25px var(--color-primary), inset 0 0 25px var(--color-primary);
      animation: pulseBorder 2s infinite ease-in-out;
    }

    @keyframes pulseBorder {
      0%, 100% {
        box-shadow: 0 0 15px var(--color-primary), inset 0 0 15px var(--color-primary);
      }
      50% {
        box-shadow: 0 0 30px var(--color-primary), inset 0 0 30px var(--color-primary);
      }
    }

    .scan-line {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: var(--color-primary);
  border-radius: 2px;
  box-shadow: 0 0 20px var(--color-primary);
  animation: scan 3s infinite ease-in-out;
}

@keyframes scan {
  0% {
    top: 0;
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  50% {
    top: 100%;
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    top: 0;
    opacity: 0;
  }
}

    .scan-dots {
      position: absolute;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, transparent 1px, rgba(0, 212, 255, 0.05) 1px);
      background-size: 15px 15px;
      opacity: 0.6;
    }

    @keyframes pulseText {
      0%, 100% {
        opacity: 0.8;
      }
      50% {
        opacity: 1;
      }
    }

    .scan-result {
      padding: 20px;
      background: var(--color-card);
      backdrop-filter: blur(10px);
      border-radius: 18px;
      border: 1px solid var(--color-border);
      display: none;
      box-shadow: 0 6px 16px var(--color-shadow);
      animation: fadeIn 0.5s ease;
    }

    .scan-result.active {
      display: block;
    }

    .scan-result h3 {
      margin-bottom: 15px;
      color: var(--color-success);
      font-size: 1.3rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .result-content {
      word-break: break-all;
      padding: 15px;
      background: rgba(0, 0, 0, 0.1);
      border-radius: 14px;
      font-size: 1.05rem;
      line-height: 1.5;
    }

    /* Generator section */
    .generator-section {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .input-group {
      position: relative;
    }

    .input-group input {
      width: 100%;
      padding: 18px 20px;
      border-radius: 16px;
      border: none;
      background: var(--color-card);
      color: var(--color-text);
      font-size: 1.05rem;
      border: 1px solid var(--color-border);
      transition: var(--transition);
      box-shadow: 0 6px 14px var(--color-shadow);
      backdrop-filter: blur(10px);
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.25);
    }

    .btn {
      padding: 18px;
      background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
      border: none;
      border-radius: 16px;
      color: white;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      box-shadow: 0 6px 18px rgba(0, 212, 255, 0.35);
      backdrop-filter: blur(10px);
    }

    .btn:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 22px rgba(0, 212, 255, 0.45);
    }

    .btn:active {
      transform: translateY(0);
    }

    .qr-result-container {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      margin-top: 10px;
      background: var(--color-card);
      backdrop-filter: blur(10px);
      border-radius: 18px;
      padding: 25px 20px;
      border: 1px solid var(--color-border);
      box-shadow: 0 6px 16px var(--color-shadow);
      animation: fadeIn 0.5s ease;
    }

    .qr-result-container.active {
      display: flex;
    }

    .qr-display {
      background: white;
      padding: 15px;
      border-radius: 14px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      max-width: 280px;
      aspect-ratio: 1/1;
    }

    #qr-code {
      width: 100%;
      height: 100%;
    }

    .action-buttons {
      display: flex;
      gap: 15px;
      width: 100%;
    }

    .action-btn {
      flex: 1;
      padding: 16px;
      border-radius: 14px;
      border: none;
      background: var(--color-card);
      color: var(--color-text);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      box-shadow: 0 4px 12px var(--color-shadow);
      backdrop-filter: blur(10px);
    }

    .action-btn:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-3px);
    }

    .action-btn i {
      color: var(--color-primary);
    }

    #file-input {
      display: none;
    }

    .hidden {
      display: none;
    }

    /* Crop modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      padding: 15px;
    }

    .modal.active {
      display: flex;
      animation: fadeIn 0.3s ease;
    }

    .modal-content {
      background: var(--color-glass);
      backdrop-filter: blur(25px);
      border-radius: 22px;
      padding: 25px;
      width: 100%;
      max-width: 95vw;
      max-height: 90vh;
      display: flex;
      flex-direction: column;
      gap: 20px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .modal-title {
      font-size: 1.4rem;
      color: var(--color-primary);
      font-weight: 700;
    }

    .close-btn {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: var(--color-text);
      font-size: 1.8rem;
      cursor: pointer;
      transition: var(--transition);
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }

    .close-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      color: var(--color-primary);
      transform: rotate(90deg);
    }

    .crop-container {
      width: 100%;
      height: 60vh;
      min-height: 300px;
      overflow: hidden;
      border-radius: 16px;
      background: rgba(0, 0, 0, 0.2);
    }

    #crop-image {
      max-width: 100%;
      max-height: 100%;
      display: block;
    }

    .modal-footer {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 15px;
    }

    .confirm-crop {
      padding: 16px 32px;
      background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
      color: white;
      border: none;
      border-radius: 14px;
      font-weight: 600;
      font-size: 1.1rem;
      cursor: pointer;
      transition: var(--transition);
      flex: 1;
      max-width: 320px;
      box-shadow: 0 6px 18px rgba(0, 212, 255, 0.4);
    }

    .confirm-crop:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 22px rgba(0, 212, 255, 0.5);
    }

    /* Responsive adjustments */
    @media (max-width: 480px) {
      .header {
        padding: 20px 15px;
      }

      .header h1 {
        font-size: 1.6rem;
      }

      .header p {
        font-size: 0.95rem;
      }

      .tab-btn {
        font-size: 0.95rem;
        padding: 12px 8px;
      }

      .scanner-options {
        grid-template-columns: 1fr;
      }

      .option-card {
        padding: 18px;
      }

      .input-group input {
        padding: 16px;
      }

      .btn {
        padding: 16px;
        font-size: 1.05rem;
      }

      .crop-container {
        height: 50vh;
      }
    }

    /* Animations */
    @keyframes pulse {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.02);
      }
      100% {
        transform: scale(1);
      }
    }

.cyron-profile {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  margin-top: 15px;
  animation: fadeIn 1s ease;
  justify-content: flex-start;
}

.cyron-avatar {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  box-shadow: 0 0 10px;
  flex-shrink: 0;
}

.cyron-info {
  font-family: "Segoe UI", "Arial", sans-serif; /*  Fuente m谩s normal */
  text-align: left;
  max-width: 250px;
  min-width: 200px;
}

.cyron-name {
  font-size: 1.1rem;
  font-weight: bold;
}

.cyron-role {
  font-size: 0.85rem;
  opacity: 0.8;
}

/* Contenedor que reserva el espacio del texto */
.cyron-typing-box {
  height: 1.2em;
  overflow: hidden;
}

/* Texto animado */
.cyron-typing {
  display: inline-block;
  font-size: 0.9rem;
  font-family: "Segoe UI", "Arial", sans-serif;
  white-space: nowrap;
  overflow: hidden;
  animation: blink-caret 0.8s step-end infinite;
  max-width: 250px;
}


/* Entrada suave */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}
  </style>
</head>
<body>
  <div class="container">
    <header class="header pulse">
 <div class="cyron-profile">
  <img src="https://orvex-web.github.io/resources/multimedia/image/cyron-orvex.gif" alt="Cyron IA" class="cyron-avatar">
  <div class="cyron-info">
    <strong>Cyron</strong><br>
    <span id="cyron-typing" class="cyron-typing"></span>
  </div>
</div>
</header>

    <div class="tabs">
      <button class="tab-btn active" data-tab="scanner">
        <i class="fas fa-camera"></i> Escanear
      </button>
      <button class="tab-btn" data-tab="generator">
        <i class="fas fa-qrcode"></i> Generar
      </button>
    </div>

    <div id="scanner" class="tab-content active">
      <div class="scanner-section">
        <div class="scanner-options">
          <div class="option-card" id="upload-option">
            <i class="fas fa-image"></i>
            <div>
              <h3>Subir Imagen</h3>
              <p>
                Desde tu galer铆a
              </p>
            </div>
          </div>

          <div class="option-card" id="camera-option">
            <i class="fas fa-camera"></i>
            <div>
              <h3>Usar C谩mara</h3>
              <p>
                Escanear en tiempo real
              </p>
            </div>
          </div>
        </div>

        <input type="file" id="file-input" accept="image/*">

        <div class="preview-container">
          <img id="image-preview" alt="Vista previa">
          <video id="camera-preview" autoplay playsinline></video>

          <div class="scan-overlay">
            <div class="scan-animation">
              <div class="scan-frame"></div>
              <div class="scan-line"></div>
              <div class="scan-dots"></div>
            </div>
          </div>
        </div>

        <div class="scan-result">
          <h3><i class="fas fa-check-circle"></i> Resultado</h3>
          <div class="result-content" id="scan-result"></div>
        </div>

        <div class="action-buttons">
          <button id="reset-btn" class="action-btn hidden">
            <i class="fas fa-redo"></i> Reiniciar
          </button>
        </div>
      </div>
    </div>

    <div id="generator" class="tab-content">
      <div class="generator-section">
        <div class="input-group">
          <input type="text" id="qr-input" placeholder="Introduce texto o URL aqu铆...">
        </div>

        <button id="generate-btn" class="btn">
          <i class="fas fa-bolt"></i> Generar C贸digo QR
        </button>

        <div class="qr-result-container">
          <div class="qr-display">
            <canvas id="qr-code"></canvas>
          </div>

          <button id="download-btn" class="btn download-btn">
            <i class="fas fa-download"></i> Descargar QR
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="crop-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Recortar Imagen</h3>
        <button class="close-btn" id="close-modal">&times;</button>
      </div>
      <div class="crop-container">
        <img id="crop-image" alt="Imagen a recortar">
      </div>
      <div class="modal-footer">
        <button class="confirm-crop" id="crop-btn">Recortar y Escanear</button>
      </div>
    </div>
  </div>

  <script>
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    const uploadOption = document.getElementById('upload-option');
    const cameraOption = document.getElementById('camera-option');
    const fileInput = document.getElementById('file-input');
    const imagePreview = document.getElementById('image-preview');
    const cameraPreview = document.getElementById('camera-preview');
    const previewContainer = document.querySelector('.preview-container');
    const resetBtn = document.getElementById('reset-btn');
    const scanOverlay = document.querySelector('.scan-overlay');
    const scanResult = document.querySelector('.scan-result');
    const scanResultContent = document.getElementById('scan-result');
    const qrInput = document.getElementById('qr-input');
    const generateBtn = document.getElementById('generate-btn');
    const qrResultContainer = document.querySelector('.qr-result-container');
    const qrCodeElement = document.getElementById('qr-code');
    const downloadBtn = document.getElementById('download-btn');
    const cropModal = document.getElementById('crop-modal');
    const cropImage = document.getElementById('crop-image');
    const closeModal = document.getElementById('close-modal');
    const cropBtn = document.getElementById('crop-btn');

    let stream = null;
    let cropper = null;
    let canvas = document.createElement('canvas');
    let ctx = canvas.getContext('2d');
    let scanning = false;

    tabBtns.forEach(btn => {
      btn.addEventListener('click', () => {

        tabBtns.forEach(b => b.classList.remove('active'));
        tabContents.forEach(c => c.classList.remove('active'));

        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.add('active');

        if (stream) {
          stopCamera();
          previewContainer.classList.remove('active');
        }

        resetScanner();

        qrResultContainer.classList.remove('active');
      });
    });

    uploadOption.addEventListener('click', () => {
      fileInput.click();
    });

    fileInput.addEventListener('change', (e) => {
      if (e.target.files && e.target.files[0]) {
        const file = e.target.files[0];
        const reader = new FileReader();

        reader.onload = function(event) {

          cropImage.src = event.target.result;
          cropModal.classList.add('active');

          if (cropper) {
            cropper.destroy();
          }

          cropper = new Cropper(cropImage, {
            aspectRatio: 1,
            viewMode: 1,
            autoCropArea: 0.8,
            guides: true,
            background: false,
            movable: true,
            rotatable: false,
            scalable: true,
            zoomable: true,
            ready: function() {
              cropImage.style.width = '100%';
              cropImage.style.height = 'auto';
            }
          });
        }

        reader.readAsDataURL(file);
      }
    });

    cameraOption.addEventListener('click', () => {
      startCamera();
    });

    resetBtn.addEventListener('click', () => {
      resetScanner();
    });

    generateBtn.addEventListener('click', () => {
      generateQRCode();
    });

    downloadBtn.addEventListener('click', () => {
      downloadQRCode();
    });

    closeModal.addEventListener('click', () => {
      cropModal.classList.remove('active');
      resetScanner();
    });

    cropBtn.addEventListener('click', () => {
      if (cropper) {

        const croppedCanvas = cropper.getCroppedCanvas({
          width: 800,
          height: 800
        });

        imagePreview.src = croppedCanvas.toDataURL('image/png');

        cropModal.classList.remove('active');

        previewContainer.classList.add('active');
        imagePreview.classList.add('active');
        cameraPreview.classList.remove('active');

        resetBtn.classList.remove('hidden');

        setTimeout(() => {
          startScanning('image');
        }, 500);
      }
    });

    function startCamera() {
      if (scanning) return;

      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        navigator.mediaDevices.getUserMedia({
          video: {
            facingMode: 'environment',
            width: {
              ideal: 1280
            },
            height: {
              ideal: 1280
            }
          }
        })
        .then(function(mediaStream) {
          scanning = true;
          stream = mediaStream;
          cameraPreview.srcObject = stream;
          previewContainer.classList.add('active');
          cameraPreview.classList.add('active');
          imagePreview.classList.remove('active');

          scanCamera();
        })
        .catch(function(error) {
          alert('Error al acceder a la c谩mara: ' + error.message);
        });
      } else {
        alert('Tu navegador no soporta el acceso a la c谩mara.');
      }
    }

    function stopCamera() {
      if (stream) {
        scanning = false;
        stream.getTracks().forEach(track => track.stop());
        stream = null;
        cameraPreview.classList.remove('active');
      }
    }

    function scanCamera() {
      if (!scanning || !cameraPreview.classList.contains('active')) return;

      if (cameraPreview.videoWidth > 0) {
        canvas.width = cameraPreview.videoWidth;
        canvas.height = cameraPreview.videoHeight;

        ctx.drawImage(cameraPreview, 0, 0, canvas.width, canvas.height);

        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const code = jsQR(imageData.data, imageData.width, imageData.height);

        if (code) {

          scanResultContent.textContent = code.data;
          scanResult.classList.add('active');

          scanOverlay.classList.remove('active');

          resetBtn.classList.remove('hidden');

          stopCamera();
        } else {

          requestAnimationFrame(scanCamera);
        }
      } else {

        setTimeout(scanCamera, 100);
      }
    }

    function startScanning(source) {

      scanOverlay.classList.add('active');
      scanResult.classList.remove('active');

      setTimeout(() => {
        if (source === 'image') {
          scanImage();
        }
      },
        800);
    }

    function scanImage() {
      canvas.width = imagePreview.naturalWidth || imagePreview.width;
      canvas.height = imagePreview.naturalHeight || imagePreview.height;
      ctx.drawImage(imagePreview,
        0,
        0,
        canvas.width,
        canvas.height);

      const imageData = ctx.getImageData(0,
        0,
        canvas.width,
        canvas.height);
      const code = jsQR(imageData.data,
        imageData.width,
        imageData.height);

      setTimeout(() => {
        scanOverlay.classList.remove('active');

        if (code) {
          scanResultContent.textContent = code.data;
          scanResult.classList.add('active');
        } else {
          alert('No se pudo detectar ning煤n c贸digo QR. Intenta con otra imagen.');
        }
      },
        2000);
    }

    function resetScanner() {

      stopCamera();

      imagePreview.src = '';
      imagePreview.classList.remove('active');
      cameraPreview.classList.remove('active');
      previewContainer.classList.remove('active');

      scanOverlay.classList.remove('active');
      scanResult.classList.remove('active');

      fileInput.value = '';

      resetBtn.classList.add('hidden');

      scanning = false;
    }

    function generateQRCode() {
      const inputText = qrInput.value.trim();

      if (!inputText) {
        alert('Por favor introduce un texto o URL');
        return;
      }

      qrCodeElement.width = 256;
      qrCodeElement.height = 256;
      const ctx = qrCodeElement.getContext('2d');
      ctx.clearRect(0, 0, qrCodeElement.width, qrCodeElement.height);

      QRCode.toCanvas(
        qrCodeElement,
        inputText,
        {
          width: 256,
          margin: 2,
          color: {
            dark: '#000000',
            light: '#ffffff'
          },
          errorCorrectionLevel: 'H'
        },
        function(error) {
          if (error) {
            console.error(error);
            alert('Error al generar el c贸digo QR');
            return;
          }

          qrResultContainer.classList.add('active');

          qrResultContainer.scrollIntoView({
            behavior: 'smooth', block: 'center'
          });
        }
      );
    }

    function downloadQRCode() {
      const ctx = qrCodeElement.getContext('2d');

      const tempCanvas = document.createElement('canvas');
      tempCanvas.width = qrCodeElement.width;
      tempCanvas.height = qrCodeElement.height;
      const tempCtx = tempCanvas.getContext('2d');

      tempCtx.fillStyle = '#ffffff';
      tempCtx.fillRect(0,
        0,
        tempCanvas.width,
        tempCanvas.height);

      tempCtx.drawImage(qrCodeElement,
        0,
        0);

      const isUrl = /^https?:\/\//i.test(qrInput.value);
      const prefix = isUrl ? 'qr-link': 'qr-text';
      const randomId = Math.random().toString(36).substring(2,
        6).toUpperCase();
      const fileName = `orvex-${prefix}-${randomId}.png`;

      const link = document.createElement('a');
      link.href = tempCanvas.toDataURL('image/png');
      link.download = fileName;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
  </script>
<script>
  const phrases = [
    "Analizando patrones del c贸digo QR...",
    "Supervisando el flujo de escaneo.",
    "Preparando esc谩ner inteligente.",
    "Escaneando datos con precisi贸n avanzada.",
    "Monitoreando entrada visual del usuario.",
    "Decodificando s铆mbolos QR...",
    "Alineando par谩metros de lectura 贸ptica.",
    "Confirmando autenticidad del c贸digo QR.",
    "Evaluando consistencia del escaneo.",
    "Interpretando informaci贸n digital.",
    "Esperando imagen v谩lida del usuario...",
    "Validaci贸n en tiempo real activada.",
    "Optimizaci贸n de escaneo en progreso.",
    "Comprobando condiciones de lectura...",
    "Listo para nuevas instrucciones.",
    "Adaptando algoritmos al entorno.",
    "Preparado para escaneos complejos.",
    "Priorizando precisi贸n sobre velocidad.",
    "Calibrando visor de entrada...",
    "El escaneo est谩 bajo mi control."
  ];

  const typingElement = document.getElementById("cyron-typing");
  let phraseIndex = 0;
  let charIndex = 0;
  let isDeleting = false;

  function typeSmart() {
    const currentPhrase = phrases[phraseIndex];
    const currentText = currentPhrase.substring(0, charIndex);
    typingElement.innerHTML = currentText;

    if (!isDeleting && charIndex < currentPhrase.length) {
      charIndex++;
      setTimeout(typeSmart, 40);
    } else if (isDeleting && charIndex > 0) {
      charIndex--;
      setTimeout(typeSmart, 20);
    } else {
      isDeleting = !isDeleting;
      if (!isDeleting) {
        phraseIndex = (phraseIndex + 1) % phrases.length;
      }
      setTimeout(typeSmart, isDeleting ? 500 : 1000);
    }
  }

  window.addEventListener("DOMContentLoaded", typeSmart);
</script>
</body>
</html>
